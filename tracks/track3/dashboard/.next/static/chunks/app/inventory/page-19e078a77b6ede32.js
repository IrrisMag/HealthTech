(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{4347:function(e,t,a){Promise.resolve().then(a.bind(a,9140))},9140:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var r=a(7437),n=a(2265),o=a(429),s=a(3639),i=a(7829),c=a(1723);let l=(0,a(9763).Z)("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);var d=a(9116);function u(){let[e,t]=(0,n.useState)([]),[a,u]=(0,n.useState)(!0),[m,p]=(0,n.useState)(null),[h,y]=(0,n.useState)("all");(0,n.useEffect)(()=>{g()},[]);let g=async()=>{try{p(null);let e=await (0,d.nz)();if(Array.isArray(e)){let a=e.map(e=>({...e,id:e.id||"item-".concat(Date.now(),"-").concat(Math.random()),blood_type:e.blood_type||"O+",quantity:e.quantity||1,status:e.status||"available",location:e.location||"Main Storage",temperature:e.temperature||4,expiry_date:e.expiry_date||new Date().toISOString(),created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}));t(a)}else{let a=(null==e?void 0:e.inventory)||(null==e?void 0:e.data)||[];if(Array.isArray(a)){let e=a.map(e=>({...e,id:e.id||"item-".concat(Date.now(),"-").concat(Math.random()),blood_type:e.blood_type||"O+",quantity:e.quantity||1,status:e.status||"available",location:e.location||"Main Storage",temperature:e.temperature||4,expiry_date:e.expiry_date||new Date().toISOString(),created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}));t(e)}else t([])}}catch(e){p(e instanceof Error?e.message:"Failed to load inventory"),t([])}finally{u(!1)}},f=e=>{switch(e){case"critical":return"bg-red-100 text-red-800";case"expired":return"bg-gray-100 text-gray-800";case"reserved":return"bg-yellow-100 text-yellow-800";default:return"bg-green-100 text-green-800"}},_=e=>({"A+":"bg-red-500","A-":"bg-red-600","B+":"bg-blue-500","B-":"bg-blue-600","AB+":"bg-purple-500","AB-":"bg-purple-600","O+":"bg-orange-500","O-":"bg-orange-600"})[e]||"bg-gray-500",x=Array.isArray(e)?e.filter(e=>"all"===h||e.blood_type===h):[];return a?(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-96",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading inventory..."})]})})}):m?(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-96",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(s.Z,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Inventory"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:m}),(0,r.jsx)("button",{onClick:g,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Retry"})]})})}):(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsx)(o.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\uD83E\uDE78 Blood Inventory Management"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Real-time blood stock monitoring and management"})]}),(0,r.jsx)("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh"})]})}),(0,r.jsx)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:["all","A+","A-","B+","B-","AB+","AB-","O+","O-"].map(e=>(0,r.jsx)("button",{onClick:()=>y(e),className:"px-3 py-1 rounded-full text-sm font-medium transition-colors ".concat(h===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"all"===e?"All Types":e},e))})}),(0,r.jsx)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:0===x.length?(0,r.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,r.jsx)(i.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Inventory Found"}),(0,r.jsx)("p",{className:"text-gray-600",children:"all"===h?"No blood inventory items available.":"No ".concat(h," blood type items found.")})]}):x.map((e,t)=>(0,r.jsxs)(o.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.05*t},className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold text-white ".concat(_(e.blood_type)),children:e.blood_type}),(0,r.jsx)("span",{className:"status-indicator ".concat(f(e.status||"available")),children:(e.status||"available").toUpperCase()})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Quantity"}),(0,r.jsxs)("span",{className:"font-semibold",children:[e.quantity," units"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Location"}),(0,r.jsx)("span",{className:"text-sm",children:e.location})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-600 flex items-center",children:[(0,r.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),"Expires"]}),(0,r.jsx)("span",{className:"text-sm",children:new Date(e.expiry_date).toLocaleDateString()})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-600 flex items-center",children:[(0,r.jsx)(l,{className:"w-4 h-4 mr-1"}),"Temperature"]}),(0,r.jsxs)("span",{className:"text-sm",children:[e.temperature,"\xb0C"]})]})]})]},e.id))})]})}},9116:function(e,t,a){"use strict";a.d(t,{LP:function(){return b},Mf:function(){return g},OE:function(){return w},PM:function(){return y},RT:function(){return h},a7:function(){return f},nz:function(){return m},wS:function(){return p}});var r=a(3464);let n=a(257).env.NEXT_PUBLIC_TRACK3_API_URL||"https://healthtech-production-e602.up.railway.app",o=r.Z.create({baseURL:n,timeout:15e3,headers:{"Content-Type":"application/json"}}),s=r.Z.create({baseURL:"https://healthtech-production-e602.up.railway.app",timeout:1e4,headers:{"Content-Type":"application/json"}}),i=r.Z.create({baseURL:"https://healthtech-production-e602.up.railway.app",timeout:15e3,headers:{"Content-Type":"application/json"}}),c=r.Z.create({baseURL:"https://healthtech-production-e602.up.railway.app",timeout:1e4,headers:{"Content-Type":"application/json"}}),l=e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e};o.interceptors.request.use(l),s.interceptors.request.use(l),i.interceptors.request.use(l),c.interceptors.request.use(l);let d=async()=>{try{let e=(await o.get("/dashboard/metrics")).data;if("success"===e.status&&e.data)return{total_donors:e.data.total_donors,total_donations_today:e.data.total_donations_today,total_donations_this_month:e.data.total_donations_this_month,total_inventory_units:e.data.total_inventory_units,units_expiring_soon:e.data.units_expiring_soon,pending_requests:e.data.pending_requests,emergency_requests:e.data.emergency_requests,blood_type_distribution:e.data.blood_type_distribution,component_distribution:e.data.component_distribution,last_updated:e.data.last_updated};throw Error("Invalid response format from dashboard metrics API")}catch(e){throw console.error("Error fetching dashboard metrics:",e),Error("Failed to fetch dashboard metrics. Please check if the data service is running.")}},u=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;try{let t=(await o.get("/analytics/performance?days=".concat(e))).data;if("success"===t.status)return{performance_metrics:t.performance_metrics,recent_improvements:t.recent_improvements,timestamp:t.timestamp};throw Error("Invalid response format from analytics API")}catch(e){throw console.error("Error fetching historical metrics:",e),Error("Failed to fetch analytics data. Please check if the analytics service is running.")}},m=async()=>{try{let e=(await o.get("/inventory")).data;if("success"===e.status&&e.inventory)return e.inventory;throw Error("Invalid response format from inventory API")}catch(e){throw console.error("Error fetching blood inventory:",e),Error("Failed to fetch blood inventory. Please check if the data service is running.")}},p=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;try{try{console.log("\uD83D\uDD04 Attempting batch forecast...");let t=["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(async t=>{try{let a=(await o.get("/forecast/".concat(encodeURIComponent(t),"?periods=").concat(e))).data;if("success"===a.status&&a.forecasts)return a.forecasts.map(e=>({blood_type:t,date:e.date,predicted_demand:e.predicted_demand,confidence_interval_lower:e.lower_bound,confidence_interval_upper:e.upper_bound}));return[]}catch(e){return console.error("❌ Error fetching forecast for ".concat(t,":"),e),[]}}),a=(await Promise.all(t)).flat();if(0===a.length)throw Error("No forecast data available from any blood type");return console.log("✅ Successfully loaded ".concat(a.length," forecast records using real ARIMA models")),a}catch(e){throw console.error("❌ Batch forecast failed:",e),e}}catch(e){throw console.error("❌ Error fetching forecasts:",e),Error("Failed to fetch forecast data. Please check if the forecasting service is running.")}},h=async()=>{try{let e=(await o.get("/recommendations/active")).data;if("success"===e.status&&e.recommendations)return e.recommendations;throw Error("Invalid response format from recommendations API")}catch(e){throw console.error("Error fetching optimization recommendations:",e),Error("Failed to fetch optimization recommendations. Please check if the optimization service is running.")}},y=async()=>{try{let e=(await o.get("/donors")).data;if("success"===e.status&&e.donors)return e.donors;throw Error("Invalid response format from donors API")}catch(e){throw console.error("Error fetching donors:",e),Error("Failed to fetch donors data. Please check if the data service is running.")}},g=async()=>{try{let e=(await o.post("/optimize")).data;if("success"===e.status)return e;throw Error("Invalid response format from optimization API")}catch(e){throw console.error("Error triggering optimization:",e),Error("Failed to trigger optimization. Please check if the optimization service is running.")}},f=async()=>{try{let[e,t,a,r,n]=await Promise.all([d(),m(),p(),h(),u(7)]),o=_(t),s=v(o,r),i=x(e,n);return{metrics:e,blood_types:o,forecasts:a,recommendations:r,alerts:s,trends:i}}catch(e){throw console.error("Error fetching dashboard data:",e),Error("Failed to fetch dashboard data. Please check if all backend services are running.")}},_=e=>["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(t=>{let a;let r=e.filter(e=>e.blood_type===t).length;return a=r<=5?"critical":r<=15?"low":r<=30?"adequate":r<=40?"optimal":"excess",{type:t,current_stock:r,safety_stock:20,reorder_point:15,days_until_expiry:Math.floor(30*Math.random())+1,status:a,trend:["increasing","decreasing","stable"][Math.floor(3*Math.random())]}}),x=(e,t)=>{if(!t||0===t.length)return{total_donors:{value:"+12%",isPositive:!0},total_donations_today:{value:"+5",isPositive:!0},total_inventory_units:{value:"-2%",isPositive:!1},units_expiring_soon:{value:"+3",isPositive:!1},pending_requests:{value:"-1",isPositive:!0},emergency_requests:{value:"0",isPositive:!0},total_donations_this_month:{value:"+18%",isPositive:!0}};let a=t[0],r=(e,t)=>{if(0===t)return{value:"N/A",isPositive:!0};let a=(e-t)/t*100;return{value:"".concat(a>=0?"+":"").concat(a.toFixed(1),"%"),isPositive:a>=0}},n=(e,t)=>{let a=e-t;return{value:"".concat(a>=0?"+":"").concat(a),isPositive:a>=0}};return{total_donors:r(e.total_donors,a.total_donors),total_donations_today:n(e.total_donations_today,a.total_donations_today),total_inventory_units:r(e.total_inventory_units,a.total_inventory_units),units_expiring_soon:n(e.units_expiring_soon,a.units_expiring_soon),pending_requests:n(e.pending_requests,a.pending_requests),emergency_requests:n(e.emergency_requests,a.emergency_requests),total_donations_this_month:r(e.total_donations_this_month,a.total_donations_this_month)}},v=(e,t)=>{let a=[];return e.forEach(e=>{"critical"===e.status&&a.push({id:"critical-".concat(e.type),type:"critical",title:"Critical Stock Level",message:"".concat(e.type," blood type has critically low stock (").concat(e.current_stock," units)"),blood_type:e.type,timestamp:new Date().toISOString(),acknowledged:!1})}),t.forEach(e=>{"emergency"===e.priority_level&&a.push({id:"emergency-".concat(e.recommendation_id),type:"critical",title:"Emergency Order Required",message:e.reasoning,blood_type:e.blood_type,timestamp:e.created_at,acknowledged:!1})}),a},b=async e=>{try{return(await o.post("/optimization/execute/".concat(e))).data}catch(e){throw console.error("Failed to execute optimization order:",e),Error("Failed to execute optimization order. Please check if the optimization service is running.")}},w=async(e,t)=>{try{return(await o.post("/reports/generate",{type:e,filters:t||{},format:"pdf"})).data}catch(e){throw console.error("Failed to generate report:",e),Error("Failed to generate report. Please check if the reporting service is running.")}}},3639:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1723:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7829:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]])}},function(e){e.O(0,[763,971,117,744],function(){return e(e.s=4347)}),_N_E=e.O()}]);