(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[796],{8917:function(e,t,r){Promise.resolve().then(r.bind(r,2335))},2335:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(7437),o=r(2265),n=r(429),s=r(5805),i=r(9763);let c=(0,i.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),l=(0,i.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),d=(0,i.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),u=(0,i.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var h=r(1047),m=r(9116);function p(){let[e,t]=(0,o.useState)([]),[r,i]=(0,o.useState)(!0),[p,y]=(0,o.useState)(null),[g,f]=(0,o.useState)(""),[x,_]=(0,o.useState)(""),[v,b]=(0,o.useState)("");(0,o.useEffect)(()=>{w()},[]);let w=async()=>{try{i(!0),y(null);let e=await (0,m.PM)();t(e),console.log("✅ Loaded ".concat(e.length," donor records"))}catch(e){console.error("❌ Donors loading failed:",e),y(e instanceof Error?e.message:"Failed to load donors from backend services"),t([])}finally{i(!1)}},j=e.filter(e=>{let t=e.name.toLowerCase().includes(g.toLowerCase())||e.phone.includes(g),r=!x||e.blood_type===x,a=!v||e.eligibility_status===v;return t&&r&&a}),N=e=>{switch(e){case"eligible":return"bg-green-100 text-green-800";case"deferred":return"bg-yellow-100 text-yellow-800";case"ineligible":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=e=>({"A+":"bg-red-100 text-red-800","A-":"bg-red-200 text-red-900","B+":"bg-blue-100 text-blue-800","B-":"bg-blue-200 text-blue-900","AB+":"bg-purple-100 text-purple-800","AB-":"bg-purple-200 text-purple-900","O+":"bg-orange-100 text-orange-800","O-":"bg-orange-200 text-orange-900"})[e]||"bg-gray-100 text-gray-800";return r?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-96",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading donors..."})]})})}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)(n.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\uD83D\uDC65 Donor Management"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage blood donors and track donation history"})]}),(0,a.jsx)("button",{onClick:w,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh"})]})}),p&&(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(s.Z,{className:"w-5 h-5 text-red-600 mr-2"}),(0,a.jsx)("span",{className:"text-red-800",children:p})]})}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Search donors...",value:g,onChange:e=>f(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("select",{value:x,onChange:e=>_(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Blood Types"}),["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Statuses"}),(0,a.jsx)("option",{value:"eligible",children:"Eligible"}),(0,a.jsx)("option",{value:"deferred",children:"Deferred"}),(0,a.jsx)("option",{value:"ineligible",children:"Ineligible"})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(l,{className:"w-4 h-4 mr-2"}),j.length," of ",e.length," donors"]})]}),(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map((e,t)=>(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"card hover:shadow-lg transition-shadow",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(k(e.blood_type)),children:e.blood_type})]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(s.Z,{className:"w-4 h-4 mr-2"}),e.age," years old, ",e.gender]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(d,{className:"w-4 h-4 mr-2"}),e.phone]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(u,{className:"w-4 h-4 mr-2"}),e.donation_count," donations"]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Last: ",new Date(e.last_donation).toLocaleDateString()]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(N(e.eligibility_status)),children:e.eligibility_status.charAt(0).toUpperCase()+e.eligibility_status.slice(1)}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",e.id.slice(0,8),"..."]})]})]})]},e.id))}),0===j.length&&!r&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(s.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No donors found"}),(0,a.jsx)("p",{className:"text-gray-600",children:g||x||v?"Try adjusting your filters":"No donor data available"})]})]})}},9116:function(e,t,r){"use strict";r.d(t,{LP:function(){return b},Mf:function(){return g},OE:function(){return w},PM:function(){return y},RT:function(){return p},a7:function(){return f},nz:function(){return h},wS:function(){return m}});var a=r(3464);let o=r(257).env.NEXT_PUBLIC_TRACK3_API_URL||"https://healthtech-production-e602.up.railway.app",n=a.Z.create({baseURL:o,timeout:15e3,headers:{"Content-Type":"application/json"}}),s=a.Z.create({baseURL:"https://healthtech-production-e602.up.railway.app",timeout:1e4,headers:{"Content-Type":"application/json"}}),i=a.Z.create({baseURL:"https://healthtech-production-e602.up.railway.app",timeout:15e3,headers:{"Content-Type":"application/json"}}),c=a.Z.create({baseURL:"https://healthtech-production-e602.up.railway.app",timeout:1e4,headers:{"Content-Type":"application/json"}}),l=e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e};n.interceptors.request.use(l),s.interceptors.request.use(l),i.interceptors.request.use(l),c.interceptors.request.use(l);let d=async()=>{try{let e=(await n.get("/dashboard/metrics")).data;if("success"===e.status&&e.data)return{total_donors:e.data.total_donors,total_donations_today:e.data.total_donations_today,total_donations_this_month:e.data.total_donations_this_month,total_inventory_units:e.data.total_inventory_units,units_expiring_soon:e.data.units_expiring_soon,pending_requests:e.data.pending_requests,emergency_requests:e.data.emergency_requests,blood_type_distribution:e.data.blood_type_distribution,component_distribution:e.data.component_distribution,last_updated:e.data.last_updated};throw Error("Invalid response format from dashboard metrics API")}catch(e){throw console.error("Error fetching dashboard metrics:",e),Error("Failed to fetch dashboard metrics. Please check if the data service is running.")}},u=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;try{let t=(await n.get("/analytics/performance?days=".concat(e))).data;if("success"===t.status)return{performance_metrics:t.performance_metrics,recent_improvements:t.recent_improvements,timestamp:t.timestamp};throw Error("Invalid response format from analytics API")}catch(e){throw console.error("Error fetching historical metrics:",e),Error("Failed to fetch analytics data. Please check if the analytics service is running.")}},h=async()=>{try{let e=(await n.get("/inventory")).data;if("success"===e.status&&e.inventory)return e.inventory;throw Error("Invalid response format from inventory API")}catch(e){throw console.error("Error fetching blood inventory:",e),Error("Failed to fetch blood inventory. Please check if the data service is running.")}},m=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;try{try{console.log("\uD83D\uDD04 Attempting batch forecast...");let t=["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(async t=>{try{let r=(await n.get("/forecast/".concat(encodeURIComponent(t),"?periods=").concat(e))).data;if("success"===r.status&&r.forecasts)return r.forecasts.map(e=>({blood_type:t,date:e.date,predicted_demand:e.predicted_demand,confidence_interval_lower:e.lower_bound,confidence_interval_upper:e.upper_bound}));return[]}catch(e){return console.error("❌ Error fetching forecast for ".concat(t,":"),e),[]}}),r=(await Promise.all(t)).flat();if(0===r.length)throw Error("No forecast data available from any blood type");return console.log("✅ Successfully loaded ".concat(r.length," forecast records using real ARIMA models")),r}catch(e){throw console.error("❌ Batch forecast failed:",e),e}}catch(e){throw console.error("❌ Error fetching forecasts:",e),Error("Failed to fetch forecast data. Please check if the forecasting service is running.")}},p=async()=>{try{let e=(await n.get("/recommendations/active")).data;if("success"===e.status&&e.recommendations)return e.recommendations;throw Error("Invalid response format from recommendations API")}catch(e){throw console.error("Error fetching optimization recommendations:",e),Error("Failed to fetch optimization recommendations. Please check if the optimization service is running.")}},y=async()=>{try{let e=(await n.get("/donors")).data;if("success"===e.status&&e.donors)return e.donors;throw Error("Invalid response format from donors API")}catch(e){throw console.error("Error fetching donors:",e),Error("Failed to fetch donors data. Please check if the data service is running.")}},g=async()=>{try{let e=(await n.post("/optimize")).data;if("success"===e.status)return e;throw Error("Invalid response format from optimization API")}catch(e){throw console.error("Error triggering optimization:",e),Error("Failed to trigger optimization. Please check if the optimization service is running.")}},f=async()=>{try{let[e,t,r,a,o]=await Promise.all([d(),h(),m(),p(),u(7)]),n=x(t),s=v(n,a),i=_(e,o);return{metrics:e,blood_types:n,forecasts:r,recommendations:a,alerts:s,trends:i}}catch(e){throw console.error("Error fetching dashboard data:",e),Error("Failed to fetch dashboard data. Please check if all backend services are running.")}},x=e=>["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(t=>{let r;let a=e.filter(e=>e.blood_type===t).length;return r=a<=5?"critical":a<=15?"low":a<=30?"adequate":a<=40?"optimal":"excess",{type:t,current_stock:a,safety_stock:20,reorder_point:15,days_until_expiry:Math.floor(30*Math.random())+1,status:r,trend:["increasing","decreasing","stable"][Math.floor(3*Math.random())]}}),_=(e,t)=>{if(!t||0===t.length)return{total_donors:{value:"+12%",isPositive:!0},total_donations_today:{value:"+5",isPositive:!0},total_inventory_units:{value:"-2%",isPositive:!1},units_expiring_soon:{value:"+3",isPositive:!1},pending_requests:{value:"-1",isPositive:!0},emergency_requests:{value:"0",isPositive:!0},total_donations_this_month:{value:"+18%",isPositive:!0}};let r=t[0],a=(e,t)=>{if(0===t)return{value:"N/A",isPositive:!0};let r=(e-t)/t*100;return{value:"".concat(r>=0?"+":"").concat(r.toFixed(1),"%"),isPositive:r>=0}},o=(e,t)=>{let r=e-t;return{value:"".concat(r>=0?"+":"").concat(r),isPositive:r>=0}};return{total_donors:a(e.total_donors,r.total_donors),total_donations_today:o(e.total_donations_today,r.total_donations_today),total_inventory_units:a(e.total_inventory_units,r.total_inventory_units),units_expiring_soon:o(e.units_expiring_soon,r.units_expiring_soon),pending_requests:o(e.pending_requests,r.pending_requests),emergency_requests:o(e.emergency_requests,r.emergency_requests),total_donations_this_month:a(e.total_donations_this_month,r.total_donations_this_month)}},v=(e,t)=>{let r=[];return e.forEach(e=>{"critical"===e.status&&r.push({id:"critical-".concat(e.type),type:"critical",title:"Critical Stock Level",message:"".concat(e.type," blood type has critically low stock (").concat(e.current_stock," units)"),blood_type:e.type,timestamp:new Date().toISOString(),acknowledged:!1})}),t.forEach(e=>{"emergency"===e.priority_level&&r.push({id:"emergency-".concat(e.recommendation_id),type:"critical",title:"Emergency Order Required",message:e.reasoning,blood_type:e.blood_type,timestamp:e.created_at,acknowledged:!1})}),r},b=async e=>{try{return(await n.post("/optimization/execute/".concat(e))).data}catch(e){throw console.error("Failed to execute optimization order:",e),Error("Failed to execute optimization order. Please check if the optimization service is running.")}},w=async(e,t)=>{try{return(await n.post("/reports/generate",{type:e,filters:t||{},format:"pdf"})).data}catch(e){throw console.error("Failed to generate report:",e),Error("Failed to generate report. Please check if the reporting service is running.")}}},1047:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[763,971,117,744],function(){return e(e.s=8917)}),_N_E=e.O()}]);