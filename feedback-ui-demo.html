<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthTech Feedback UI - Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .star-rating button:hover { color: #fbbf24; }
        .star-rating button.active { color: #fbbf24; }
    </style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen flex">
        <!-- Left side - Background image placeholder -->
        <div class="flex-1 bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center">
            <div class="text-white text-center">
                <h2 class="text-4xl font-bold mb-4">🏥 Douala General Hospital</h2>
                <p class="text-xl">Your feedback helps us improve our services</p>
            </div>
        </div>
        
        <!-- Right side - Feedback form -->
        <div class="flex-1 pl-16 flex items-center">
            <form id="feedbackForm" class="p-5 flex flex-col gap-6 max-w-[600px] flex-1">
                <h1 class="text-3xl font-bold text-blue-800">🏥 Patient Feedback</h1>
                <p class="text-gray-600">Help us improve our services by sharing your experience</p>

                <div id="statusMessage" class="hidden p-4 rounded-lg border"></div>

                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700">Patient ID (Optional)</label>
                    <input type="text" id="patientId" placeholder="e.g., PAT001 (auto-generated if empty)" 
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>

                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700">Department *</label>
                    <select id="department" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">Select Department</option>
                        <option value="emergency">🚨 Emergency</option>
                        <option value="cardiology">❤️ Cardiology</option>
                        <option value="surgery">🔪 Surgery</option>
                        <option value="pediatrics">👶 Pediatrics</option>
                        <option value="maternity">🤱 Maternity</option>
                        <option value="radiology">📷 Radiology</option>
                        <option value="laboratory">🧪 Laboratory</option>
                        <option value="pharmacy">💊 Pharmacy</option>
                        <option value="reception">📋 Reception</option>
                    </select>
                </div>

                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700">Language *</label>
                    <select id="language" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">Select Language</option>
                        <option value="fr">🇫🇷 Français</option>
                        <option value="en">🇬🇧 English</option>
                        <option value="bassa">🇨🇲 Bassa</option>
                        <option value="ewondo">🇨🇲 Ewondo</option>
                        <option value="nguemba">🇨🇲 Nguemba</option>
                    </select>
                </div>

                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700">Feedback Type *</label>
                    <select id="feedbackType" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">Select Feedback Type</option>
                        <option value="staff">👥 Staff Service</option>
                        <option value="waiting_time">⏰ Waiting Time</option>
                        <option value="facilities">🏢 Facilities</option>
                        <option value="treatment">💊 Treatment Quality</option>
                        <option value="general">📝 General</option>
                        <option value="billing">💰 Billing</option>
                        <option value="appointment">📅 Appointment</option>
                    </select>
                </div>

                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700">Rating *</label>
                    <div class="flex gap-2 items-center star-rating">
                        <button type="button" onclick="setRating(1)" class="text-2xl text-gray-300 hover:text-yellow-400">⭐</button>
                        <button type="button" onclick="setRating(2)" class="text-2xl text-gray-300 hover:text-yellow-400">⭐</button>
                        <button type="button" onclick="setRating(3)" class="text-2xl text-gray-300 hover:text-yellow-400">⭐</button>
                        <button type="button" onclick="setRating(4)" class="text-2xl text-gray-300 hover:text-yellow-400">⭐</button>
                        <button type="button" onclick="setRating(5)" class="text-2xl text-gray-300 hover:text-yellow-400">⭐</button>
                        <span id="ratingText" class="ml-2 text-sm text-gray-600">5/5 - Excellent</span>
                    </div>
                </div>

                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700">Your Feedback *</label>
                    <textarea id="feedback" required placeholder="Please share your experience with us. Your feedback helps us improve our services..." 
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[120px] resize-none"></textarea>
                    <p class="text-xs text-gray-500">💡 Our AI will analyze your feedback sentiment and extract keywords automatically</p>
                </div>

                <div class="flex gap-3">
                    <button type="button" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                        🎤 Voice (Coming Soon)
                    </button>
                    
                    <button type="submit" id="submitBtn" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium">
                        📤 Submit Feedback
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentRating = 5;

        function setRating(rating) {
            currentRating = rating;
            const stars = document.querySelectorAll('.star-rating button');
            const ratingText = document.getElementById('ratingText');
            
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                    star.style.color = '#fbbf24';
                } else {
                    star.classList.remove('active');
                    star.style.color = '#d1d5db';
                }
            });

            const ratingLabels = ['Very Poor', 'Poor', 'Average', 'Good', 'Excellent'];
            ratingText.textContent = `${rating}/5 - ${ratingLabels[rating - 1]}`;
        }

        document.getElementById('feedbackForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const statusMessage = document.getElementById('statusMessage');
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"></div>Analyzing & Submitting...';
            
            const feedbackData = {
                patient_id: document.getElementById('patientId').value || `PAT${Date.now()}`,
                text_feedback: document.getElementById('feedback').value,
                rating: currentRating,
                feedback_type: document.getElementById('feedbackType').value,
                language: document.getElementById('language').value,
                department: document.getElementById('department').value
            };

            try {
                const response = await fetch('http://feedback.localhost:8001/feedback', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(feedbackData)
                });

                const result = await response.json();
                
                if (response.ok) {
                    statusMessage.className = 'p-4 rounded-lg border bg-green-50 text-green-700 border-green-200';
                    statusMessage.textContent = `✅ Feedback submitted successfully! Sentiment: ${result.sentiment}, Priority: ${result.priority}`;
                    statusMessage.classList.remove('hidden');
                    
                    // Reset form
                    document.getElementById('feedbackForm').reset();
                    setRating(5);
                } else {
                    throw new Error(result.detail || 'Submission failed');
                }
            } catch (error) {
                statusMessage.className = 'p-4 rounded-lg border bg-red-50 text-red-700 border-red-200';
                statusMessage.textContent = `❌ Error: ${error.message}. Please try again.`;
                statusMessage.classList.remove('hidden');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '📤 Submit Feedback';
            }
        });

        // Initialize rating
        setRating(5);
    </script>
</body>
</html>
